+++
title = "Linux ls 解析"  # 文章标题
date = 2020-05-03T16:57:42+08:00  # 自动添加日期信息
draft = false  # 设为false可被编译为HTML，true供本地修改
tags = ["linux"]  # 文章标签，可设置多个，用逗号隔开。Hugo会自动生成标签的子URL

+++

## ls

ls 命令是Linux下最常用的指令之一。ls命令为英文单词 list 的缩写，正如英文单词 list 的意思，其功能是列出指定目录下的内容及其相关属性信息。

默认状态下，ls命令会列出当前目录的内容。而带上参数后，我们可以用ls做更多的事情。作为最基础同时又是使用频率很高的命令，我们很有必要搞清楚ls命令的用法，那么接下来一起看看吧！

**语法格式:** ls [选项] [文件]

**常用参数：**

| -a   | 显示所有文件及目录 (包括以“.”开头的隐藏文件)     |
| ---- | ------------------------------------------------ |
| -l   | 使用长格式列出文件及目录信息                     |
| -r   | 将文件以相反次序显示(默认依英文字母次序)         |
| -t   | 根据最后的修改时间排序                           |
| -A   | 同 -a ，但不列出 “.” (当前目录) 及 “..” (父目录) |
| -S   | 根据文件大小排序                                 |
| -R   | 递归列出所有子目录                               |

---

```bash
[redhat@Redhat7 boot]$ ls -lih vmlinuz-3.10.0-1127.el7.x86_64 
75 -rwxr-xr-x. 1 root root 6.5M 2月  19 05:43 vmlinuz-3.10.0-1127.el7.x86_64
```

>第一列：inode；
第二列：文件种类和权限；
第三列： 硬链接个数；
第四列： 所属用户；
第五列： 所归属的用户组；
第六列： 文件或目录的大小；
第七列和第八列：最后访问或修改时间；
第九列：文件名或目录名

## inode

inode 译成中文就是索引节点。每个存储设备或存储设备的分区（存储设备是硬盘、软盘、U盘等等）被格式化为文件系统后，应该有两部份，一部份是inode，另一部份是Block，Block是用来存储数据用的。而inode呢，就是用来存储这些数 据的信息，这些信息包括文件大小、属主、归属的用户组、读写权限等。inode为每个文件进行信息索引，所以就有了inode的数值。操作系统根据指令， 能通过inode值最快的找到相对应的文件。

做个比喻，比如一本书，存储设备或分区就相当于这本书，Block相当于书中的每一页，inode 就相当于这本书前面的目录，一本书有很多的内容，如果想查找某部份的内容，我们可以先查目录，通过目录能最快的找到我们想要看的内容。虽然不太恰当，但还是比较形象。

当我们用ls 查看某个目录或文件时，如果加上-i 参数，就可以看到inode节点了

## 文件种类

Linux文件类型常见的有：普通文件、目录文件、字符设备文件和块设备文件、符号链接文件等，现在我们进行一个简要的说明。

**1.** **普通文件** 

我们用 ls -lh 来查看某个文件的属性，可以看到有类似-rwxrwxrwx，值得注意的是第一个符号是 - ，这样的文件在Linux中就是普通文件。这些文件一般是用一些相关的应用程序创建，比如图像工具、文档工具、归档工具... .... 或 cp工具等。这类文件的删除方式是用rm 命令。 另外，依照文件的内容，又大略可以分为：

**1>.** **纯文本档(ASCII)：**

这是Linux系统中最多的一种文件类型，称为纯文本档是因为内容为我们人类可以直接读到的数据，例如数字、字母等等。 几乎只要我们可以用来做为设定的文件都属于这一种文件类型。 举例来说，你可以用命令： cat ~/.bashrc 来看到该文件的内容。 (cat 是将一个文件内容读出来的指令).

**2>.** **二进制文件(binary)：**

Linux系统其实仅认识且可以执行二进制文件(binary file)。Linux当中的可执行文件(scripts, 文字型批处理文件不算)就是这种格式的文件。 刚刚使用的命令cat就是一个binary file。

**3>.** **数据格式文件(data)：** 

有些程序在运作的过程当中会读取某些特定格式的文件，那些特定格式的文件可以被称为数据文件 (data file)。举例来说，我们的Linux在使用者登录时，都会将登录的数据记录在 /var/log/wtmp那个文件内，该文件是一个data file，他能够透过last这个指令读出来！ 但是使用cat时，会读出乱码～因为他是属于一种特殊格式的文件？

**2.** **目录文件**

当我们在某个目录下执行，看到有类似 drwxr-xr-x ，这样的文件就是目录，目录在Linux是一个比较特殊的文件。注意它的第一个字符是d。创建目录的命令可以用 mkdir 命令，或cp命令，cp可以把一个目录复制为另一个目录。删除用rm 或rmdir命令。 

**3.** **字符设备或块设备文件** 

如时您进入/dev目录，列一下文件，会看到类似如下的:

[root@localhost ~]# ls -al /dev/tty

crw-rw-rw- 1 root tty 5, 0 11-03 15:11 /dev/tty

[root@localhost ~]# ls -la /dev/sda1

brw-r----- 1 root disk 8, 1 11-03 07:11 /dev/sda1

我们看到/dev/tty的属性是 crw-rw-rw- ，注意前面第一个字符是 c ，这表示字符设备文件。比如猫等串口设备。我们看到 /dev/sda1 的属性是 brw-r----- ，注意前面的第一个字符是b，这表示块设备，比如硬盘，光驱等设备。

这个种类的文件，是用mknode来创建，用rm来删除。目前在最新的Linux发行版本中，我们一般不用自己来创建设备文件。因为这些文件是和内核相关联的。

与系统周边及储存等相关的一些文件， 通常都集中在/dev这个目录之下！通常又分为两种：

**区块(block)设备档 ：**

就是一些储存数据， 以提供系统随机存取的接口设备，举例来说，硬盘与软盘等就是啦！ 你可以随机的在硬盘的不同区块读写，这种装置就是成组设备！你可以自行查一下/dev/sda看看， 会发现第一个属性为[ b ]！

**字符(character)设备文件：**

亦即是一些串行端口的接口设备， 例如键盘、鼠标等等！这些设备的特色就是一次性读取的，不能够截断输出。 举例来说，你不可能让鼠标跳到另一个画面，而是滑动到另一个地方！第一个属性为 [ c ]。

**4.** **数据接口文件(sockets)：** 

数据接口文件（或者：套接口文件），这种类型的文件通常被用在网络上的数据承接了。我们可以启动一个程序来监听客户端的要求， 而客户端就可以透过这个socket来进行数据的沟通了。第一个属性为 [ s ]， 最常在/var/run这个目录中看到这种文件类型了。

例如：当我们启动MySQL服务器时，会产生一个mysql.sock的文件。

[root@localhost ~]# ls -lh /var/lib/mysql/mysql.sock 

srwxrwxrwx 1 mysql mysql 0 04-19 11:12 /var/lib/mysql/mysql.sock

注意这个文件的属性的第一个字符是 s。

**5.** **符号链接文件****：** 

当我们查看文件属性时，会看到有类似 lrwxrwxrwx,注意第一个字符是l，这类文件是链接文件。是通过ln -s 源文件名 新文件名 。上面是一个例子，表示setup.log是install.log的软链接文件。怎么理解呢？这和Windows操作系统中的快捷方式有点相似。

符号链接文件的创建方法举例:

[root@localhost test]# ls -lh log2012.log

-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log

[root@localhost test]# ln -s log2012.log linklog.log

[root@localhost test]# ls -lh *.log

lrwxrwxrwx 1 root root  11 11-22 06:58 linklog.log -> log2012.log

-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log

**6. 数据输送文件（FIFO,pipe）:**

FIFO也是一种特殊的文件类型，他主要的目的在解决多个程序同时存取一个文件所造成的错误问题。 FIFO是first-in-first-out的缩写。第一个属性为[p] 

## 权限

三个为一组，且均为『rwx』 的三个参数的组合。其中，[ r ]代表可读(read)、[ w ]代表可写(write)、[ x ]代表可执行(execute)。 要注意的是，这三个权限的位置不会改变，如果没有权限，就会出现减号[ - ]而已。

- 第一组为『文件拥有者的权限』；
- 第二组为『同群组的权限』；
- 第三组为『其他非本群组的权限』。

**如何改变文件属性与权限**

- chgrp ：改变文件所属群组
- chown ：改变文件拥有者
- chmod ：改变文件的权限, SUID, SGID, SBIT等等的特性

## 硬链接

ln命令是linux系统中一个非常重要命令，英文全称是“link”，即链接的意思，它的功能是为某一个文件在另外一个位置建立一个同步的链接。 一种是hard link，又称为硬链接；另一种是symbolic link，又称为符号链接。

通俗一点理解，可以把硬链接当成源文件的副本，他和源文件一样的大小，但是事实上却不占任何空间。符号链接可以理解为类似windows一样的快捷方式。

符号链接 ：

- \1. 符号链接以路径的形式存在，类似于Windows操作系统中的快捷方式。
- \2. 符号链接可以跨文件系统 ，硬链接不可以。
- \3. 符号链接可以对一个不存在的文件名进行链接，硬链接不可以。
- \4. 符号链接可以对目录进行链接，硬链接不可以。

硬链接：

- 1.硬链接以文件副本的形式存在，但不占用实际空间。
- \2. 硬链接不允许给目录创建硬链接。
- 3.硬链接只有在同一个文件系统中才能创建。

**语法格式：** ln [参数] [源文件或目录] [目标文件或目录]

**常用参数：**

| -b   | 为每个已存在的目标文件创建备份文件                   |
| ---- | ---------------------------------------------------- |
| -d   | 此选项允许“root”用户建立目录的硬链接                 |
| -f   | 强制创建链接，即使目标文件已经存在                   |
| -n   | 把指向目录的符号链接视为一个普通文件                 |
| -i   | 交互模式，若目标文件已经存在，则提示用户确认进行覆盖 |
| -s   | 对源文件建立符号链接，而非硬链接                     |
| -v   | 详细信息模式，输出指令的详细执行过程                 |

**参考实例**

为源文件file.txt创建硬链接file_1：

```bash
[root@linuxcool ~ ]# ln /root/dir/file.txt ./file_1
```

使用ln命令的“-s”参数来创建目录的符号链接，并使用ls命令来查看链接文件的详细信息：

```bash
[root@linuxcool ~]# ln -s dir file
[root@linuxcool ~]# ls -l
总用量 4
-rw-------. 1 root root 1138 3月  11 14:48 anaconda-ks.cfg
drwxr-xr-x. 2 root root   36 4月   3 08:47 test
lrwxrwxrwx. 1 root root    4 4月   3 08:54 file -> dir
```

使用ln命令的“-v”参数来输出命令的详细执行过程：

```bash
[root@linuxcool ~]# ln -v /root/dir/file.txt ./file_1
 './file_1' => '/root/dir/file.txt'
```

使用ln命令的“-b”命令来创建目标文件的备份文件，并使用ls命令来查看：

```bash
[root@linuxcool ~]# ln -b /root/dir/file.txt ./file_1
[root@linuxcool ~]# ls
 anaconda-ks.cfg  file_1  file_1~  dir 
```

